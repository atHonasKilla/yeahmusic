<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Archivos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .file-list {
            list-style-type: none;
            padding: 0;
        }
        .file-list li {
            margin-bottom: 5px;
        }
        .file-list li a {
            text-decoration: none;
            color: #007bff;
        }
        .file-list li a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>Gestor de Archivos</h1>
    <ul class="file-list" id="fileList">
        <!-- Aquí se cargarán dinámicamente los archivos -->
    </ul>

    <script>
        // Función para cargar los archivos y directorios del directorio actual
        function loadFilesInDirectory() {
            const currentDirectory = ".";
            const fileList = document.getElementById("fileList");
            fileList.innerHTML = "";

            fetchFiles(currentDirectory, fileList);
        }

        // Función para obtener y cargar archivos y directorios
        function fetchFiles(directory, fileListElement) {
            fetch(directory)
                .then(response => response.text())
                .then(data => {
                    const parser = new DOMParser();
                    const htmlDoc = parser.parseFromString(data, 'text/html');
                    const links = htmlDoc.querySelectorAll('a');

                    links.forEach(link => {
                        const listItem = document.createElement("li");
                        const fileUrl = directory + '/' + link.getAttribute('href');
                        const fileName = link.textContent;

                        const linkElement = document.createElement("a");
                        linkElement.textContent = fileName;
                        linkElement.href = `javascript:void(0);`;
                        linkElement.addEventListener("click", () => openFile(fileUrl));

                        listItem.appendChild(linkElement);
                        fileListElement.appendChild(listItem);
                    });
                })
                .catch(error => console.error('Error fetching files:', error));
        }

        // Función para abrir archivos
        function openFile(fileUrl) {
            if (fileUrl.endsWith(".txt")) {
                fetch(fileUrl)
                    .then(response => response.text())
                    .then(data => {
                        const txtWindow = window.open("", "_blank");
                        txtWindow.document.write(`<html><head><title>${fileUrl}</title></head><body><pre>${data}</pre></body></html>`);
                        txtWindow.document.close();
                    })
                    .catch(error => console.error('Error fetching text file:', error));
            } else if (fileUrl.endsWith(".mp3") || fileUrl.endsWith(".mp4")) {
                window.open(fileUrl, "_blank");
            }
        }

        // Cargar archivos del directorio actual al cargar la página
        document.addEventListener("DOMContentLoaded", loadFilesInDirectory);
    </script>
</body>
</html>
